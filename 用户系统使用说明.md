# 用户系统使用说明

## 🎯 功能概述

现在系统支持**多用户独立数据管理**！每个用户可以设置自己的用户名，系统会为不同用户分别保存标注和翻译数据。

## ✨ 主要特性

### 1. 用户名管理
- 📝 在个人中心设置用户名
- 👤 每个用户有独立的头像标识
- 🔄 可以随时修改用户名

### 2. 数据隔离
- ✅ 每个用户的标注数据独立保存
- ✅ 不同用户看到的标注互不干扰
- ✅ 翻译数据同样按用户分离

### 3. 访客模式
- 🎫 未设置用户名时自动生成访客ID
- 📊 访客也有独立的数据空间
- ⬆️ 随时可以从访客升级为正式用户

## 📖 使用指南

### 步骤1：设置用户名

1. **打开个人中心**
   - 点击导航栏的"个人中心"

2. **编辑用户名**
   - 点击"✏️ 编辑用户名"按钮
   - 输入你的用户名（2-20个字符）
   - 点击"保存"

3. **完成设置**
   - 头像和用户名会立即更新
   - 显示成功提示："用户名设置成功！你的标注数据已独立保存"

### 步骤2：使用个性化功能

设置用户名后，你的所有操作都会关联到你的账户：

#### 📝 标注功能
1. 打开"阅读文章"页面
2. 开启"标注模式"
3. 选择颜色
4. 点击单词进行标注
5. **标注会自动保存到你的账户下**

#### 🔄 切换用户
不同的设备或浏览器可以使用不同的用户名：
- 用户A的标注 → 只有用户A能看到
- 用户B的标注 → 只有用户B能看到
- 完全独立，互不影响！

## 🎨 界面说明

### 个人中心 - 用户信息区

```
┌─────────────────────────────────────┐
│  ┌────┐                             │
│  │ DL │  学习者                     │
│  └────┘  坚持每天阅读英文文章        │
│          ✏️ 编辑用户名               │
└─────────────────────────────────────┘
```

点击"编辑用户名"后：

```
┌─────────────────────────────────────┐
│  设置用户名                          │
│  用户名用于区分不同用户的标注和学习数据│
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 请输入用户名（2-20个字符）   │   │
│  └─────────────────────────────┘   │
│                                     │
│  [ 保存 ]  [ 取消 ]                │
└─────────────────────────────────────┘
```

## 💡 使用场景

### 场景1：家庭共享设备
小明和小红共用一台电脑学习英语：

```
小明登录：
- 设置用户名：xiaoming
- 标注单词：apple (绿色), banana (黄色)
- 保存：xiaoming 的数据

小红登录：
- 设置用户名：xiaohong  
- 标注单词：apple (红色), orange (橙色)
- 保存：xiaohong 的数据

结果：
- 小明打开文章，看到 apple (绿色), banana (黄色)
- 小红打开文章，看到 apple (红色), orange (橙色)
- 互不干扰！✨
```

### 场景2：多设备学习
在不同设备使用相同用户名：

```
家里电脑：
- 用户名：student123
- 标注了20个单词

公司电脑：
- 用户名：student123
- 看不到之前的标注（因为数据在本地浏览器）

注意：当前版本数据存储在浏览器本地，
      同一用户名在不同浏览器需要重新标注
```

### 场景3：班级学习
老师和学生使用同一套系统：

```
老师账户：
- 用户名：Teacher_Wang
- 标注：重点语法、难点单词

学生A：
- 用户名：Student_001
- 标注：自己不会的单词

学生B：
- 用户名：Student_002
- 标注：自己不会的单词

每个人看到的都是自己的标注！
```

## ❓ 常见问题

### Q1: 不设置用户名可以使用吗？
**A:** 可以！系统会自动生成访客ID（Guest_xxx），你仍然可以保存标注数据。但建议设置一个自己的用户名，便于识别。

### Q2: 修改用户名会丢失数据吗？
**A:** 会的！修改用户名相当于切换到新账户，之前的标注会关联到旧用户名。建议一开始就设置好用户名，不要频繁更改。

### Q3: 忘记用户名怎么办？
**A:** 用户名保存在浏览器的 localStorage 中，可以：
1. 打开浏览器开发者工具（F12）
2. 进入 Console 标签
3. 输入：`localStorage.getItem('username')`
4. 查看当前用户名

### Q4: 可以删除用户名吗？
**A:** 目前没有直接删除功能。如果需要重置，可以：
1. 清除浏览器数据
2. 或修改为新的用户名

### Q5: 不同浏览器可以共享数据吗？
**A:** 不可以。当前版本数据存储在浏览器本地（localStorage），不同浏览器之间不共享。如果需要跨浏览器使用，需要在每个浏览器中设置相同的用户名，并重新标注。

### Q6: 头像图标怎么确定的？
**A:** 头像图标使用用户名的前两个字符（大写）。例如：
- 用户名 `student` → 头像 `ST`
- 用户名 `张三` → 头像 `张三`
- 访客 → 头像 `G`

## 🔧 技术说明

### 数据存储
```javascript
// 用户名存储
localStorage.setItem('username', 'your_username');

// 获取用户名
const username = localStorage.getItem('username');

// 标注数据存储
后端数据库：user_ip 字段现在存储用户名
```

### API调用
```javascript
// 加载标注（带用户名）
GET /api/articles/{id}/annotations/?username=your_username

// 保存标注（带用户名）
POST /api/articles/{id}/save_annotations/
Body: {
  annotations: [...],
  username: "your_username"
}
```

### 向后兼容
- 如果没有提供用户名，系统会使用IP地址（旧版本行为）
- 已有的标注数据不会丢失
- 可以逐步迁移到新的用户名系统

## 🎯 最佳实践

### ✅ 推荐做法
1. **首次使用就设置用户名** - 避免后续迁移数据
2. **使用易记的用户名** - 如学号、昵称等
3. **记住你的用户名** - 方便在其他设备使用
4. **固定一个浏览器** - 保证数据连续性

### ❌ 避免做法
1. 频繁修改用户名
2. 使用过于复杂的用户名
3. 多人共用同一个用户名
4. 在公共电脑上保存重要标注

## 📊 数据迁移

### 从访客升级到正式用户

如果你之前使用访客模式（Guest_xxx）标注了很多单词，现在想设置正式用户名：

**注意**：当前版本不支持自动数据迁移。设置新用户名后，旧的访客标注将不再显示。

**解决方案**：
1. 记录下当前的访客ID（在控制台输入 `localStorage.getItem('username')`）
2. 如需保留数据，暂时不要修改用户名
3. 或者重新标注（推荐，借此机会复习）

## 🚀 未来功能

计划中的功能：
- [ ] 账户系统（真正的注册登录）
- [ ] 云端数据同步（跨设备共享）
- [ ] 数据导入导出
- [ ] 用户名修改时的数据迁移工具
- [ ] 多用户协作学习

---

## 📝 快速开始

现在就试试吧！

1. 打开 [个人中心](profile.html)
2. 点击"✏️ 编辑用户名"
3. 输入你的用户名
4. 开始你的个性化学习之旅！🎉

---

**提示**：如果你在使用过程中遇到任何问题，请参考上面的常见问题部分，或联系开发者。

