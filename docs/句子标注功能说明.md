# 📝 句子标注功能说明

## 🎯 功能概述

新增了**句子标注模式**，允许用户点击单词时标注整个句子，而不是单个单词或整个段落。这个功能非常适合标记重要语句、精彩句子或需要重点学习的内容。

---

## ✨ 核心特性

### 1. 智能句子识别
- ✅ **自动分割** - 按标点符号（. ! ? ; :）自动识别句子边界
- ✅ **保留完整性** - 包含标点符号的完整句子
- ✅ **精确定位** - 每个句子有唯一ID

### 2. 句子标注
- ✅ **点击标注** - 点击句子中任意单词即可标注整个句子
- ✅ **6种颜色** - 使用不同颜色标注不同类型的句子
- ✅ **视觉效果** - 彩色下划线 + 淡背景色
- ✅ **取消标注** - 再次点击取消标注

### 3. 模式互斥
- ✅ **单词标注模式** - 标注单个单词
- ✅ **句子标注模式** - 标注整个句子
- ✅ **翻译模式** - 显示单词翻译
- ✅ 三种模式互斥，同一时间只能开启一种

### 4. 数据管理
- ✅ **自动保存** - 标注后自动保存到LocalStorage
- ✅ **按页保存** - 每页的句子标注独立保存
- ✅ **多用户隔离** - 不同用户的标注数据独立

---

## 📖 使用说明

### 步骤0：查看标注的句子

1. **切换到句子Tab**
   ```
   在右侧侧边栏顶部，点击"📄 句子"标签
   ```

2. **查看句子列表**
   ```
   - 显示所有已标注的句子
   - 显示句子的标注颜色
   - 点击句子自动滚动定位
   - 可以删除不需要的标注
   ```

3. **切换回单词Tab**
   ```
   点击"📝 单词"标签查看单词列表
   ```

### 步骤1：开启句子标注模式

1. **打开文章**
   ```
   从文章列表选择任意文章
   ```

2. **开启句子标注模式**
   ```
   勾选"句子标注"复选框
   ```

3. **选择颜色**
   ```
   从6种颜色中选择一种
   - 🟡 黄色 - 精彩句子
   - 🟢 绿色 - 重点句子
   - 🟠 橙色 - 需复习句子
   - 🔵 蓝色 - 例句
   - 🟣 紫色 - 高级句型
   - 🔴 红色 - 难点句子
   ```

---

### 步骤2：标注句子

1. **点击单词**
   ```
   在句子标注模式下，点击句子中的任意单词
   ```

2. **查看效果**
   ```
   整个句子会：
   - 显示彩色下划线
   - 添加淡色背景
   - 字体稍加粗
   ```

3. **取消标注**
   ```
   再次点击同一句子中的单词即可取消标注
   ```

---

### 步骤3：切换模式

**单词标注模式**：
```
勾选"单词标注" → 点击单词 → 标注该单词
```

**句子标注模式**：
```
勾选"句子标注" → 点击单词 → 标注整个句子
```

**翻译模式**：
```
勾选"翻译模式" → 点击单词 → 显示翻译
```

**注意**：三种模式互斥，开启一个会自动关闭其他两个

---

## 🎨 视觉效果

### 单词标注效果
```
The quick brown fox → [quick] ← 单个单词高亮
```

### 句子标注效果
```
═══════════════════════════════════
The quick brown fox jumps over.    ← 整个句子有下划线和背景色
═══════════════════════════════════
```

### 颜色说明
- **黄色** (`#ffc107`) - 明亮，适合标记精彩内容
- **绿色** (`#28a745`) - 柔和，适合标记重点
- **橙色** (`#ff5722`) - 醒目，适合需要复习的内容
- **蓝色** (`#2196f3`) - 冷静，适合例句
- **紫色** (`#9c27b0`) - 优雅，适合高级句型
- **红色** (`#f44336`) - 警示，适合难点

---

## 💡 使用场景

### 场景1：学习精彩句子
```
阅读文章时遇到精彩的表达
→ 开启句子标注模式
→ 选择黄色
→ 点击句子中的单词
→ 整个句子被标注为精彩句子 ✨
```

### 场景2：标记语法结构
```
发现一个有用的语法结构
→ 开启句子标注模式
→ 选择蓝色
→ 标注该句子
→ 方便后续复习语法 📝
```

### 场景3：重点句型积累
```
阅读过程中：
- 黄色标注：写作可以用的句子
- 绿色标注：重点词汇句子
- 蓝色标注：语法例句
- 紫色标注：高级句型
```

### 场景4：分类学习
```
第一遍阅读：
- 用绿色标注重点句子

第二遍复习：
- 用红色标注还不理解的句子

第三遍强化：
- 用黄色标注要背诵的句子
```

---

## 🔧 技术实现

### 侧边栏Tab切换
**结构**：
- 顶部：Tab切换按钮（单词/句子）
- 单词Tab：显示单词列表和筛选器
- 句子Tab：显示标注句子列表

**切换逻辑**：
```javascript
// Tab切换函数
function switchTab(tabName) {
    // 更新按钮激活状态
    // 切换内容显示
    // 如果是句子tab，更新句子列表
}
```

### 句子列表功能
**显示内容**：
- 句子完整文本
- 标注颜色标识
- 删除按钮

**交互功能**：
- 点击句子：平滑滚动到文章中对应位置
- 高亮闪烁：定位后的视觉反馈
- 删除标注：移除不需要的句子标注

### 句子识别算法
```javascript
// 按标点符号分割句子
function splitIntoSentences(text) {
    // 匹配句子：内容 + 标点 (.!?;:)
    const regex = /[^.!?;]+[.!?;]+\s*/g;
    // 返回句子数组
}
```

### 数据存储
**LocalStorage 格式**：
```
Key: sentence_annotations_${username}_${articleId}_page${page}
Value: JSON数组
[
  {sentenceId: "sentence_0", color: "#28a745"},
  {sentenceId: "sentence_3", color: "#ffc107"}
]
```

### 样式应用
```javascript
// 彩色下划线
borderBottom: "3px solid #28a745"

// 淡背景色
backgroundColor: "rgba(40, 167, 69, 0.1)"
```

---

## 📊 数据管理

### 自动保存
- **何时保存**：每次标注/取消标注后立即保存
- **保存位置**：浏览器 LocalStorage
- **保存格式**：JSON 数组

### 按页独立
```
文章1 - 第1页：3个句子标注
文章1 - 第2页：5个句子标注
文章2 - 第1页：2个句子标注
各自独立保存 ✅
```

### 多用户隔离
```
用户A：
  sentence_annotations_userA_1_page1 = [...]

用户B：
  sentence_annotations_userB_1_page1 = [...]

互不干扰 ✅
```

---

## ⚙️ 功能配置

### 隐藏/显示标注
点击"隐藏标注"按钮可以临时隐藏所有标注（包括单词标注和句子标注）

```css
/* 隐藏状态 */
.hide-annotations .sentence.sentence-annotated {
    background: transparent !important;
    border-bottom: none !important;
}
```

### 清除所有标注
点击"清除格式"按钮会清除：
- ✅ 所有单词标注
- ✅ 所有句子标注  
- ✅ 所有翻译

---

## 🎯 与单词标注的区别

| 特性 | 单词标注 | 句子标注 |
|------|---------|---------|
| 标注范围 | 单个单词 | 整个句子 |
| 视觉效果 | 纯色背景 | 下划线+淡背景 |
| 适用场景 | 生词标记 | 重点句子 |
| 保存位置 | 服务器 | LocalStorage |
| 侧边栏显示 | 显示在词汇列表 | 不显示 |

---

## ❓ 常见问题

### Q1: 为什么有些句子识别不正确？

**原因**：
- 句子分割基于标点符号（. ! ? ; :）
- 如果文本中标点使用不规范，可能影响识别

**解决方法**：
- 系统会尽力识别
- 特殊情况下可能需要使用单词标注模式

### Q2: 句子标注会保存到服务器吗？

**不会。** 句子标注保存在浏览器LocalStorage中，原因：
- 句子ID是动态生成的，每次加载可能不同
- 句子标注是临时学习辅助工具
- 不同于单词标注的长期记录需求

### Q3: 换了浏览器还能看到句子标注吗？

**不能。** 句子标注保存在本地浏览器，不同浏览器间不共享。

### Q4: 修改"每页显示段落数"会影响句子标注吗？

**会的。** 因为句子ID是按页生成的，修改后句子ID会变化，之前的标注可能失效。

**建议**：
- 确定好每页段落数后再开始标注
- 或者仅在当前学习session中使用句子标注

### Q5: 可以同时使用单词标注和句子标注吗？

**可以，但不能同时开启。**
- 先用单词标注模式标注生词
- 再用句子标注模式标注重点句
- 两种标注可以共存，只是不能同时操作

### Q6: 句子标注支持多少种颜色？

**6种颜色**，与单词标注共用颜色选择器：
- 黄色、绿色、橙色、蓝色、紫色、红色

---

## 💡 使用技巧

### 技巧1：建立颜色系统
```
黄色 = 要背诵的句子
绿色 = 重点语法句
蓝色 = 例句模板
紫色 = 高级句型
红色 = 难点句子
```

### 技巧2：分层阅读
```
第1遍：普通阅读，不标注
第2遍：用绿色标注重点句
第3遍：用黄色标注精彩句
第4遍：用紫色标注高级句型
```

### 技巧3：配合单词标注
```
1. 用句子标注标记重点句子
2. 再用单词标注标记句子中的生词
3. 形成完整的学习体系
```

### 技巧4：清除特定颜色
目前没有按颜色清除的功能，但可以：
1. 逐个点击取消标注
2. 或使用"清除格式"清除所有

---

## 🔄 更新日志

### 2024-10-23 v2.0
- ✨ 新增侧边栏Tab切换功能
- ✨ 单词Tab：显示单词列表
- ✨ 句子Tab：显示标注句子列表
- ✨ 点击句子自动滚动定位
- ✨ 句子高亮闪烁效果
- ✨ 支持删除单个句子标注
- 🎨 优化Tab切换动画效果

### 2024-10-23 v1.0
- ✨ 新增句子标注功能
- ✨ 支持按句子边界自动识别
- ✨ 支持6种颜色标注
- ✨ 自动保存到LocalStorage
- ✨ 与单词标注模式互斥
- ✨ 支持隐藏/显示
- ✨ 支持清除所有标注

---

## 🎉 功能优势

### 学习效率
- ✅ **快速标记** - 一次点击标注整个句子
- ✅ **视觉清晰** - 下划线+背景色，效果明显
- ✅ **分类管理** - 用颜色区分不同类型

### 用户体验
- ✅ **操作简单** - 点击即可标注
- ✅ **即时生效** - 标注立即显示
- ✅ **自动保存** - 无需手动保存

### 学习场景
- ✅ **精彩句子积累** - 标记写作素材
- ✅ **语法学习** - 标记例句
- ✅ **重点复习** - 标记需要记忆的句子

---

**开始使用句子标注功能，让学习更高效！** 📚✨

