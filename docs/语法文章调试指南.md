# è¯­æ³•æ–‡ç« "æˆ‘çš„"tabè°ƒè¯•æŒ‡å—

## ğŸ› é—®é¢˜ï¼šæˆ‘çš„tabä¸‹çš„æ–‡ç« ä¸æ˜¾ç¤º

### å¿«é€Ÿä¿®å¤æ­¥éª¤

#### 1ï¸âƒ£ é‡å¯DjangoæœåŠ¡å™¨

ä¿®æ”¹äº†åç«¯ä»£ç åï¼Œå¿…é¡»é‡å¯æœåŠ¡å™¨ï¼š

```bash
# åœæ­¢å½“å‰æœåŠ¡å™¨ï¼ˆCtrl+Cï¼‰
# ç„¶åé‡æ–°å¯åŠ¨
cd /Users/guolei/work/local/stpython/paperread
python3 manage.py runserver
```

#### 2ï¸âƒ£ æ£€æŸ¥ç”¨æˆ·åè®¾ç½®

æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼Œåœ¨Consoleä¸­æ‰§è¡Œï¼š

```javascript
// æ£€æŸ¥å½“å‰ç”¨æˆ·å
console.log('å½“å‰ç”¨æˆ·å:', localStorage.getItem('paperread_username'));

// å¦‚æœæ²¡æœ‰ï¼Œè®¾ç½®ä¸€ä¸ª
localStorage.setItem('paperread_username', 'testuser');

// åˆ·æ–°é¡µé¢
location.reload();
```

#### 3ï¸âƒ£ è¿è¡Œæµ‹è¯•è„šæœ¬

åœ¨ç»ˆç«¯æ‰§è¡Œï¼š

```bash
cd /Users/guolei/work/local/stpython/paperread
python3 test_user_grammar.py
```

è¿™ä¸ªè„šæœ¬ä¼šï¼š
- æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·è¯­æ³•æ–‡ç« 
- ä¸ºæµ‹è¯•ç”¨æˆ·åˆ›å»ºç¤ºä¾‹æ–‡ç« 
- éªŒè¯æ•°æ®éš”ç¦»æ˜¯å¦æ­£å¸¸

#### 4ï¸âƒ£ æµ‹è¯•åˆ›å»ºæ–‡ç« 

1. æ‰“å¼€ `http://localhost:8000/grammar_articles.html`
2. åˆ‡æ¢åˆ°"æˆ‘çš„"tab
3. ç‚¹å‡»"æ–°å»ºæ–‡ç« "
4. å¡«å†™ï¼š
   - æ ‡é¢˜ï¼š`æµ‹è¯•æ–‡ç« `
   - éš¾åº¦ï¼š`ä¸­çº§`
   - åˆ†ç±»ï¼š`æµ‹è¯•`
   - å†…å®¹ï¼š`This is a test article.`
5. ç‚¹å‡»"ä¿å­˜"
6. æŸ¥çœ‹æ–‡ç« æ˜¯å¦æ˜¾ç¤º

---

## ğŸ” è¯¦ç»†è°ƒè¯•æ­¥éª¤

### æ­¥éª¤1ï¼šæ£€æŸ¥å‰ç«¯é…ç½®

**æ‰“å¼€æµè§ˆå™¨Consoleï¼ˆF12ï¼‰ï¼Œæ‰§è¡Œï¼š**

```javascript
// 1. æ£€æŸ¥å½“å‰tab
console.log('å½“å‰tab:', currentTab);

// 2. æ£€æŸ¥ç”¨æˆ·å
console.log('ç”¨æˆ·å:', localStorage.getItem('paperread_username'));

// 3. æ£€æŸ¥APIè°ƒç”¨
// åˆ‡æ¢åˆ°"æˆ‘çš„"tabåï¼Œè§‚å¯ŸNetworkæ ‡ç­¾ä¸­çš„è¯·æ±‚
```

**é¢„æœŸç»“æœï¼š**
- `currentTab` åº”è¯¥æ˜¯ `'mine'`
- ç”¨æˆ·åä¸åº”è¯¥ä¸ºç©º
- APIè¯·æ±‚åº”è¯¥æ˜¯ `/api/user-grammar-articles/`

### æ­¥éª¤2ï¼šæ£€æŸ¥Networkè¯·æ±‚

1. **æ‰“å¼€Networkæ ‡ç­¾**
2. **åˆ‡æ¢åˆ°"æˆ‘çš„"tab**
3. **æŸ¥æ‰¾ `user-grammar-articles` è¯·æ±‚**

**æ£€æŸ¥è¯·æ±‚ï¼š**

```
Request URL: http://localhost:8000/api/user-grammar-articles/?page=1&page_size=10&username=testuser
Request Method: GET
Status Code: 200 OK
```

**æ£€æŸ¥å“åº”ï¼š**

```json
{
  "count": 1,
  "next": null,
  "previous": null,
  "results": [
    {
      "id": 1,
      "title": "æµ‹è¯•æ–‡ç« ",
      "author": "testuser",
      ...
    }
  ]
}
```

### æ­¥éª¤3ï¼šæ£€æŸ¥åˆ›å»ºè¯·æ±‚

**åœ¨"æˆ‘çš„"tabä¸‹åˆ›å»ºæ–‡ç« æ—¶ï¼Œæ£€æŸ¥POSTè¯·æ±‚ï¼š**

```
Request URL: http://localhost:8000/api/user-grammar-articles/
Request Method: POST
Content-Type: application/json
```

**è¯·æ±‚ä½“åº”è¯¥åŒ…å«ï¼š**

```json
{
  "title": "æµ‹è¯•æ–‡ç« ",
  "content": "This is a test article.",
  "difficulty": "intermediate",
  "category": "æµ‹è¯•",
  "source": null,
  "author": "testuser"
}
```

**é‡ç‚¹æ£€æŸ¥ï¼š**
- âœ… `author` å­—æ®µåº”è¯¥å­˜åœ¨
- âœ… `author` å€¼åº”è¯¥æ˜¯å½“å‰ç”¨æˆ·å
- âœ… ä¸æ˜¯ `guest` æˆ–ç©ºå€¼

### æ­¥éª¤4ï¼šåç«¯æ•°æ®åº“æ£€æŸ¥

**æ‰“å¼€Django shellï¼š**

```bash
python3 manage.py shell
```

**æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š**

```python
from articles.models import UserGrammarArticle

# æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·è¯­æ³•æ–‡ç« 
articles = UserGrammarArticle.objects.all()
print(f"æ€»å…± {articles.count()} ç¯‡æ–‡ç« ")

# æŸ¥çœ‹æ¯ç¯‡æ–‡ç« çš„ä½œè€…
for article in articles:
    print(f"ID: {article.id}, æ ‡é¢˜: {article.title}, ä½œè€…: {article.author}")

# æŸ¥çœ‹ç‰¹å®šç”¨æˆ·çš„æ–‡ç« 
user_articles = UserGrammarArticle.objects.filter(author='testuser')
print(f"\ntestuser æœ‰ {user_articles.count()} ç¯‡æ–‡ç« ")

# é€€å‡º
exit()
```

### æ­¥éª¤5ï¼šAPIæµ‹è¯•

**ä½¿ç”¨curlæµ‹è¯•APIï¼š**

```bash
# 1. è·å–ç”¨æˆ·æ–‡ç« åˆ—è¡¨ï¼ˆæ›¿æ¢testuserä¸ºä½ çš„ç”¨æˆ·åï¼‰
curl "http://localhost:8000/api/user-grammar-articles/?username=testuser"

# 2. åˆ›å»ºæ–°æ–‡ç« 
curl -X POST http://localhost:8000/api/user-grammar-articles/ \
  -H "Content-Type: application/json" \
  -d '{
    "title": "curlæµ‹è¯•æ–‡ç« ",
    "content": "This is a test article created by curl.",
    "difficulty": "intermediate",
    "category": "æµ‹è¯•",
    "author": "testuser"
  }'

# 3. å†æ¬¡è·å–åˆ—è¡¨ï¼ŒéªŒè¯æ–‡ç« æ˜¯å¦åˆ›å»ºæˆåŠŸ
curl "http://localhost:8000/api/user-grammar-articles/?username=testuser"
```

---

## ğŸ› ï¸ å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜1ï¼šæ–‡ç« åˆ›å»ºæˆåŠŸä½†ä¸æ˜¾ç¤º

**åŸå› ï¼š** åˆ›å»ºæ—¶çš„ç”¨æˆ·åä¸æŸ¥è¯¢æ—¶çš„ç”¨æˆ·åä¸ä¸€è‡´

**è§£å†³æ–¹æ³•ï¼š**

```javascript
// åœ¨Consoleä¸­æ£€æŸ¥
const createUsername = localStorage.getItem('paperread_username');
console.log('åˆ›å»ºæ—¶çš„ç”¨æˆ·å:', createUsername);

// æ¸…é™¤å¹¶é‡æ–°è®¾ç½®
localStorage.setItem('paperread_username', 'myusername');
location.reload();
```

### é—®é¢˜2ï¼šæ˜¾ç¤º"åŠ è½½ä¸­..."ä½†æ²¡æœ‰å†…å®¹

**åŸå› ï¼š** APIè¯·æ±‚å¤±è´¥æˆ–è¿”å›ç©ºæ•°æ®

**è§£å†³æ–¹æ³•ï¼š**

1. æ£€æŸ¥Consoleæ˜¯å¦æœ‰é”™è¯¯
2. æŸ¥çœ‹Networkæ ‡ç­¾ä¸­çš„è¯·æ±‚çŠ¶æ€
3. éªŒè¯åç«¯æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
4. æ£€æŸ¥APIç«¯ç‚¹æ˜¯å¦æ­£ç¡®

### é—®é¢˜3ï¼šæ–‡ç« ä¿å­˜åˆ°äº†é”™è¯¯çš„è¡¨

**åŸå› ï¼š** åœ¨"è¯­æ³•"tabä¸‹åˆ›å»ºçš„æ–‡ç« ä¿å­˜åˆ°äº†grammar_articlesè¡¨

**è§£å†³æ–¹æ³•ï¼š**

```javascript
// ç¡®è®¤å½“å‰tab
console.log('å½“å‰tab:', currentTab);

// å¦‚æœä¸æ­£ç¡®ï¼Œæ‰‹åŠ¨åˆ‡æ¢åˆ°"æˆ‘çš„"tab
document.querySelector('.tab-btn[data-tab="mine"]').click();
```

### é—®é¢˜4ï¼šåç«¯è¿”å›404é”™è¯¯

**åŸå› ï¼š** APIç«¯ç‚¹é…ç½®é”™è¯¯

**è§£å†³æ–¹æ³•ï¼š**

æ£€æŸ¥ `articles/urls.py`ï¼š

```python
router.register(r'user-grammar-articles', UserGrammarArticleViewSet)
```

ç¡®è®¤ç«¯ç‚¹æ³¨å†Œæ­£ç¡®ï¼Œç„¶åé‡å¯æœåŠ¡å™¨ã€‚

### é—®é¢˜5ï¼šauthorå­—æ®µä¸ºç©ºæˆ–guest

**åŸå› ï¼š** localStorageä¸­æ²¡æœ‰è®¾ç½®ç”¨æˆ·å

**è§£å†³æ–¹æ³•ï¼š**

```javascript
// è®¾ç½®ç”¨æˆ·å
localStorage.setItem('paperread_username', 'myusername');

// æˆ–åœ¨ä¸ªäººä¸­å¿ƒè®¾ç½®
window.location.href = 'profile.html';
```

---

## âœ… éªŒè¯æ¸…å•

åˆ›å»ºå’ŒæŸ¥çœ‹æ–‡ç« å‰ï¼Œè¯·ç¡®è®¤ï¼š

- [ ] DjangoæœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
- [ ] æµè§ˆå™¨localStorageä¸­æœ‰paperread_username
- [ ] åœ¨"æˆ‘çš„"tabä¸‹æ“ä½œ
- [ ] Networkè¯·æ±‚æŒ‡å‘/api/user-grammar-articles/
- [ ] POSTè¯·æ±‚åŒ…å«authorå­—æ®µ
- [ ] authorå­—æ®µå€¼ä¸localStorageä¸­çš„ç”¨æˆ·åä¸€è‡´

---

## ğŸ¯ å®Œæ•´æµ‹è¯•æµç¨‹

### 1. è®¾ç½®ç”¨æˆ·å

```javascript
// åœ¨æµè§ˆå™¨Consoleä¸­
localStorage.setItem('paperread_username', 'testuser');
location.reload();
```

### 2. è¿è¡Œåç«¯æµ‹è¯•

```bash
python3 test_user_grammar.py
```

### 3. åˆ›å»ºæ–‡ç« 

1. æ‰“å¼€è¯­æ³•æ–‡ç« é¡µé¢
2. åˆ‡æ¢åˆ°"æˆ‘çš„"tab
3. ç‚¹å‡»"æ–°å»ºæ–‡ç« "
4. å¡«å†™å†…å®¹
5. ä¿å­˜

### 4. éªŒè¯æ˜¾ç¤º

1. æ–‡ç« åº”è¯¥ç«‹å³æ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­
2. åˆ·æ–°é¡µé¢ï¼Œæ–‡ç« ä»ç„¶å­˜åœ¨
3. åˆ‡æ¢åˆ°"è¯­æ³•"tabï¼Œæ–‡ç« ä¸åº”è¯¥æ˜¾ç¤º
4. åˆ‡æ¢å›"æˆ‘çš„"tabï¼Œæ–‡ç« åº”è¯¥æ˜¾ç¤º

### 5. æµ‹è¯•æ•°æ®éš”ç¦»

```javascript
// æ›´æ”¹ç”¨æˆ·å
localStorage.setItem('paperread_username', 'anotheruser');
location.reload();

// åˆ‡æ¢åˆ°"æˆ‘çš„"tabï¼Œåº”è¯¥çœ‹ä¸åˆ°ä¹‹å‰çš„æ–‡ç« 
```

---

## ğŸ“ è¿˜æ˜¯æ— æ³•è§£å†³ï¼Ÿ

### æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **æµè§ˆå™¨Consoleçš„é”™è¯¯ä¿¡æ¯**
2. **Networkæ ‡ç­¾ä¸­çš„è¯·æ±‚å’Œå“åº”**
3. **DjangoæœåŠ¡å™¨çš„æ—¥å¿—è¾“å‡º**
4. **test_user_grammar.pyçš„æ‰§è¡Œç»“æœ**

### æ£€æŸ¥å‘½ä»¤ï¼š

```bash
# 1. æ£€æŸ¥æ•°æ®åº“
python3 manage.py dbshell
sqlite> SELECT * FROM user_grammar_articles;
sqlite> .exit

# 2. æ£€æŸ¥è¿ç§»çŠ¶æ€
python3 manage.py showmigrations articles

# 3. æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—
# æŸ¥çœ‹è¿è¡Œpython3 manage.py runserverçš„ç»ˆç«¯è¾“å‡º
```

---

**æ›´æ–°æ—¥æœŸ**ï¼š2025-10-25  
**ç‰ˆæœ¬**ï¼šv1.0

